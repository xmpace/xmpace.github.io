---
layout: post
title: "一种靠谱的登录Token设计"
excerpt: "一种靠谱的登录Token设计"
background: /img/bg-post.jpg
---

客户端向服务器发送请求，服务器如何知道该请求是哪个用户发起的呢？为了标示请求的所属用户，客户端发送请求时必须带上用户的账号信息，像这样 /api/get_user_info?username=badboy123&password=goodgirl321，但这么一来，每个请求都得带上账号密码，这不安全，密码容易被泄露，于是诞生了以 token 为基础的认证方案。

客户端向服务器发送账号密码请求登录，服务器收到账号密码，校验后生成一个加密的 token 返回给客户端，后续客户端的所有请求都带上这个 token，服务器通过解密就能拿到客户端的登录账号信息了。现在密码被换成了 token，不用担心被泄露的问题了，但是 token 也会被泄露啊？是的，token 现在面临跟密码同样的问题，但 token 其实只相当于一个临时密码，用户退出登录后，这个 token 就失效了，所以token 被泄露的危害相较于密码被泄露的危害要小。

这篇文章介绍的就是一种 token 的设计。

上面介绍了 token 诞生的初衷，因此我们也知道了 token 需要满足的条件：
1. 服务端能通过 token 拿到用户账号信息（废话）
2. token 不能被伪造

我们看第 2 条就行了，防伪造，那简单啊，搞个随机数不就完了么。客户端发来账号和密码，服务端一校验，生成一个随机字符串，用随机字符串做 key，账号信息做 value，往 redis 一存就完了。就这么简单？

